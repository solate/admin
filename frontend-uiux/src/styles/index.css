/**
 * 全局样式入口
 * 统一导入所有样式文件
 *
 * CSS 规则顺序：
 * 1. @charset（可选）
 * 2. @import 语句
 * 3. @tailwind
 * 4. @layer
 * 5. 其他样式
 */

/* CSS 变量 */
@import './variables.css';

/* 样式重置 */
@import './reset.css';

/* 基础样式 */
@import './base.css';

/* Tailwind CSS */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* 原有的自定义样式（保留 Tailwind 类和组件样式）*/
@layer base {
  :root {
    /* 主题色 - 可通过偏好设置动态修改 */
    --color-primary: 37 99 235;
    /* 圆角 - 可通过偏好设置动态修改 */
    --border-radius: 0.5rem;
    --color-cta: 249 115 22;
    --color-bg: 248 250 252;
    --color-text: 30 41 59;
  }

  .dark {
    --color-primary: 59 130 246;
    --color-cta: 251 146 60;
    --color-bg: 15 23 42;
    --color-text: 241 245 249;
  }

  /* 动态主题色 Tailwind 类 */
  .bg-primary-50 { background-color: rgb(var(--color-primary) / 0.05); }
  .bg-primary-100 { background-color: rgb(var(--color-primary) / 0.1); }
  .bg-primary-500 { background-color: rgb(var(--color-primary)); }
  .bg-primary-600 { background-color: rgb(var(--color-primary) / 0.9); }
  .text-primary-500 { color: rgb(var(--color-primary)); }
  .text-primary-600 { color: rgb(var(--color-primary) / 0.9); }
  .text-primary-700 { color: rgb(var(--color-primary) / 0.8); }
  .border-primary-500 { border-color: rgb(var(--color-primary)); }
  .ring-primary-500 { --tw-ring-color: rgb(var(--color-primary)); }

  /* 暗色模式主题色 */
  .dark .bg-primary-900\/30 { background-color: rgb(var(--color-primary) / 0.15); }
  .dark .text-primary-300 { color: rgb(var(--color-primary) / 0.7); }
  .dark .text-primary-400 { color: rgb(var(--color-primary) / 0.6); }
  .dark .border-primary-800\/50 { border-color: rgb(var(--color-primary) / 0.3); }

  * {
    @apply border-slate-200 dark:border-slate-700;
  }

  body {
    @apply bg-[#F8FAFC] dark:bg-slate-900 text-slate-900 dark:text-slate-100;
    font-feature-settings: "rlig" 1, "calt" 1;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  html {
    scroll-behavior: smooth;
  }

  /* Custom scrollbar */
  ::-webkit-scrollbar {
    @apply w-2 h-2;
  }

  ::-webkit-scrollbar-track {
    @apply bg-slate-100 dark:bg-slate-800;
  }

  ::-webkit-scrollbar-thumb {
    @apply bg-slate-300 dark:bg-slate-600 rounded-full;
  }

  ::-webkit-scrollbar-thumb:hover {
    @apply bg-slate-400 dark:bg-slate-500;
  }
}

@layer components {
  /* Glass Effect - Optimized for light/dark mode */
  .glass {
    @apply bg-white/90 dark:bg-slate-800/90 backdrop-blur-md border border-slate-200/50 dark:border-slate-700/50;
  }

  .glass-card {
    @apply bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-card;
  }

  .glass-card-hover {
    @apply bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-card hover:shadow-card-hover hover:border-slate-300 dark:hover:border-slate-600 transition-all duration-200;
  }

  /* Card variants */
  .card {
    @apply bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 shadow-card;
  }

  .card-elevated {
    @apply bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 shadow-panel;
  }

  /* Gradients */
  .gradient-primary {
    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
  }

  .gradient-cta {
    background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);
  }
}

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
}

/* Focus States for Accessibility */
@layer base {
  *:focus-visible {
    @apply outline-none ring-2 ring-primary-500 ring-offset-2 dark:ring-offset-slate-900;
  }
}

/* Smooth transitions */
@layer base {
  button,
  a,
  input,
  textarea,
  select {
    @apply transition-colors duration-200;
  }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* 用户偏好设置 - 禁用动画 */
.no-animation,
.no-animation *,
.no-animation *::before,
.no-animation *::after {
  animation-duration: 0.01ms !important;
  animation-iteration-count: 1 !important;
  transition-duration: 0.01ms !important;
  scroll-behavior: auto !important;
}

/* ===== 色盲模式滤镜 ===== */

/* 红色盲 (Protanopia) - 无法感知红色 */
[data-color-blind="protanopia"] {
  filter: url('data:image/svg+xml;utf8,\
    <svg xmlns="http://www.w3.org/2000/svg">\
      <filter id="protanopia">\
        <feColorMatrix type="matrix" values="\
          0.567, 0.433, 0, 0, 0\
          0.558, 0.442, 0, 0, 0\
          0, 0.242, 0.758, 0, 0\
          0, 0, 0, 1, 0"/>\
      </filter>\
    </svg>#protanopia');
}

/* 绿色盲 (Deuteranopia) - 无法感知绿色 */
[data-color-blind="deuteranopia"] {
  filter: url('data:image/svg+xml;utf8,\
    <svg xmlns="http://www.w3.org/2000/svg">\
      <filter id="deuteranopia">\
        <feColorMatrix type="matrix" values="\
          0.625, 0.375, 0, 0, 0\
          0.7, 0.3, 0, 0, 0\
          0, 0.3, 0.7, 0, 0\
          0, 0, 0, 1, 0"/>\
      </filter>\
    </svg>#deuteranopia');
}

/* 蓝色盲 (Tritanopia) - 无法感知蓝色 */
[data-color-blind="tritanopia"] {
  filter: url('data:image/svg+xml;utf8,\
    <svg xmlns="http://www.w3.org/2000/svg">\
      <filter id="tritanopia">\
        <feColorMatrix type="matrix" values="\
          0.95, 0.05, 0, 0, 0\
          0, 0.433, 0.567, 0, 0\
          0, 0.475, 0.525, 0, 0\
          0, 0, 0, 1, 0"/>\
      </filter>\
    </svg>#tritanopia');
}

/* 高对比度模式 */
[data-high-contrast="true"] {
  --contrast-enhancement: contrast(1.2) saturate(1.3);
}
[data-high-contrast="true"] * {
  filter: var(--contrast-enhancement, none);
}
